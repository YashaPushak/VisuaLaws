<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">

	<title>Knomos VisuaLaws</title>

	<script src="scripts/jquery-2.1.4.min.js"></script>
	<script src="scripts/d3-master/d3.min.js" charset="utf-8"></script>
	<script src="scripts/jquery-ui-1.11.4.custom/jquery-ui.js" charset="utf-8"></script>
	<script src="scripts/jquery-ui-extensions/ext-jquery-ui.js" charset="utf-8"></script>
	<script src="scripts/Diff.js" charset="utf-8"></script>
	<script src="ExampleChanges.js" charset="utf-8"></script>
	<script src="scripts/icicleData.js" charset="utf-8"></script>
	<script src="scripts/BCLawsActParser.js" charset="utf-8"></script>
	<script src="scripts/PITParser.js" charset="utf-8"></script>
	<script src="scripts/xml2json.js" type="text/javascript" language="javascript"></script>
	<script src="scripts/tipsy.js" type="text/javascript" language="javascrippt"></script>
	<script src="scripts/main-diff.js" type="text/javascript" language="javascrippt"></script>
	<script src="scripts/Icicle.js" type="text/javascript" language="javascrippt"></script>
	<script src="scripts/Slider.js" type="text/javascript" language="javascrippt"></script>
	<script src="scripts/loadData.js" type="text/javascript" language="javascrippt"></script>
	<script src="scripts/scentedScroll.js" type="text/javascript" language="javascrippt"></script>
	<script src="scripts/highlight.js" type="text/javascript" language="javascrippt"></script>
	<script src="scripts/spin.min.js" type="text/javascript" language="javascrippt"></script>
	<script src="scripts/window.js" type="text/javascript" language="javascrippt"></script>

	<link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
	<link rel="stylesheet" href="scripts/jquery-ui-1.11.4.custom/jquery-ui.theme.min.css" />
	<link rel="stylesheet" href="scripts/jquery-ui-1.11.4.custom/jquery-ui.structure.min.css" />
	<link rel="stylesheet" href="scripts/jquery-ui-extensions/ext-jquery-ui.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery.tipsy/1.0.2/jquery.tipsy.css" />
	<link rel="stylesheet" href="style.css" />

	<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
	<link rel="icon" href="favicon.ico" type="image/x-icon">

	<style>
		#knomos-compass {
			width: 240px;
			margin: auto;
			margin-top: 24px;
			opacity: 0.5;
		}

		.knomos-logo {
			margin-top: 24px;
			fill: #1c75bc;
			width: 360px;
		}

		.knomos-logo-small {
			margin-left: 8px;
			fill: #165d96;
			width: 240px;
		}

		svg.knomos-logo-small .needle {
			animation: needle-flux 30s infinite
		}

		svg.knomos-compass {
			fill: #1e5aa2;
			width: 240px;
			height: 240px;
		}

		svg.knomos-compass .needle {
			animation: needle-spin 6s infinite
		}

		h2.visualaws {
			margin: 8px;
			text-align: center;
			font-style: italic;
			font-weight: normal;
			color: #1c75bc;
		}

		#select h4 {
			margin-bottom: 12px;
			font-weight: normal;
		}

		#select select {
			outline: none;
		}

		@keyframes needle-spin {
			0% {
				transform: rotateZ(0deg);
				transform-origin: 50% 50%;
				animation-timing-function: ease-in-out;
			}
			50% {
				transform: rotateZ(720deg);
				transform-origin: 50% 50%;
				animation-timing-function: ease-in-out;
			}
			100% {
				transform: rotateZ(0deg);
				transform-origin: 50% 50%;
				animation-timing-function: ease-in-out;
			}
		}

		@keyframes needle-flux {
			0% {
				transform: rotateZ(0deg);
				transform-origin: 50% 50%;
				animation-timing-function: ease;
			}
			50% {
				transform: rotateZ(360deg);
				transform-origin: 50% 50%;
				animation-timing-function: ease;
			}
			100% {
				transform: rotateZ(0deg);
				transform-origin: 50% 50%;
				animation-timing-function: ease;
			}
		}
	</style>
</head>

<body>
	<div id="title-screen">
		<div id="spinner" class="centerText">
			<!--<img class="spinner-title" src="LogoText.png?v=1.3">-->
			<!-- Generator: Adobe Illustrator 19.2.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
			<svg class="knomos-logo" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
			 x="0px" y="0px" viewBox="150 315 425 90" style="enable-background:new 0 0 720 720;" xml:space="preserve">
				<path class="letter-k" d="M150.4,346.3c0-0.9,0.8-1.7,1.8-1.7h6.6c1,0,1.8,0.8,1.8,1.7v19.3l18.9-20.3c0.3-0.4,0.8-0.7,1.4-0.7h7.5 c1.4,0,2.2,1.5,1.2,2.6l-19.6,21.1l21.1,24c0.8,0.9,0.2,2.5-1.4,2.5h-8.2c-0.8,0-1.2-0.3-1.4-0.5l-19.6-23.1v21.9 c0,0.9-0.8,1.7-1.8,1.7h-6.6c-1.1,0-1.8-0.8-1.8-1.7V346.3z"
				/>
				<path class="letter-n" d="M218.2,345.2c0-0.7,0.7-1.3,1.4-1.3h1.1c0.5,0,0.9,0.1,1.3,0.5l30.7,31.2h0.2V346c0-0.7,0.6-1.4,1.4-1.4h6.9 c0.8,0,1.4,0.6,1.4,1.4v48.2c0,0.7-0.7,1.3-1.4,1.3h-1.1c-0.5,0-0.9-0.1-1.3-0.5l-30.8-32.4h-0.2v30.8c0,0.7-0.6,1.4-1.4,1.4h-6.8 c-0.8,0-1.4-0.6-1.4-1.4V345.2z"
				/>
				<g>
					<path class="star" d="M322.8,320.8L322.8,320.8c-1.4,0-2.6-1.2-2.6-2.6v-1.3c0-0.7-0.6-1.2-1.2-1.2s-1.2,0.6-1.2,1.2v1.3 c0,1.4-1.2,2.6-2.6,2.6l0,0c-0.7,0-1.2,0.6-1.2,1.2s0.6,1.2,1.2,1.2l0,0c1.4,0,2.6,1.2,2.6,2.6v1.3c0,0.7,0.6,1.2,1.2,1.2 s1.2-0.6,1.2-1.2v-1.3c0-1.4,1.2-2.6,2.6-2.6h0c0.7,0,1.2-0.6,1.2-1.2S323.5,320.8,322.8,320.8z"
					/>
					<path class="dial" d="M354.4,368.7l-7.7-4.4c-0.8-3.8-2.4-7.3-4.7-10.3c0.1-0.2,0.2-0.4,0.2-0.7l0.8-5.4c0.1-0.7-0.1-1.4-0.7-1.8 c-0.4-0.4-0.9-0.6-1.4-0.6c-0.2,0-0.3,0-0.5,0.1l-5.3,1.2c-0.2,0.1-0.4,0.1-0.6,0.3c-3.1-2-6.6-3.4-10.3-4l-4.3-7.5 c-0.4-0.7-1.6-0.7-2,0l-4.3,7.5c-3.8,0.7-7.3,2.1-10.4,4c-0.2-0.1-0.4-0.2-0.6-0.3l-5.3-1.2c-0.2,0-0.3-0.1-0.5-0.1 c-0.5,0-1,0.2-1.4,0.6c-0.5,0.5-0.8,1.2-0.7,1.8l0.8,5.4c0,0.2,0.1,0.4,0.2,0.5c0,0,0,0.1,0.1,0.1c-2.3,3-3.9,6.5-4.7,10.3 l-7.7,4.4c-0.4,0.2-0.6,0.6-0.6,1c0,0.4,0.2,0.8,0.6,1l7.7,4.4c0.8,3.9,2.4,7.4,4.7,10.5c-0.1,0.2-0.1,0.3-0.1,0.5l-0.8,5.4 c-0.1,0.7,0.1,1.4,0.7,1.8c0.4,0.4,0.9,0.6,1.4,0.6c0.2,0,0.3,0,0.5-0.1l5.3-1.2c0.1,0,0.3-0.1,0.4-0.1c0,0,0.1,0,0.1-0.1 c3.1,2,6.7,3.3,10.5,4l4.3,7.5c0.2,0.4,0.6,0.6,1,0.6s0.8-0.2,1-0.6l4.3-7.5c3.8-0.7,7.3-2.1,10.4-4c0.2,0.1,0.4,0.2,0.6,0.3 l5.3,1.2c0.2,0,0.3,0.1,0.5,0.1c0.5,0,1-0.2,1.4-0.6c0.5-0.5,0.8-1.2,0.7-1.8l-0.8-5.4c0-0.1-0.1-0.3-0.1-0.4 c0-0.1-0.1-0.1-0.1-0.2c2.3-3,3.9-6.6,4.7-10.4l7.7-4.4c0.4-0.2,0.6-0.6,0.6-1C355,369.3,354.8,368.9,354.4,368.7z M318.9,392.7 c-13.5,0-24.1-10.1-24.1-22.9c0-12.7,10.8-23.1,24.1-23.1c13.4,0,24.2,10.3,24.2,23.1C343.1,382.6,332.5,392.7,318.9,392.7z"
					/>
					<path class="needle" d="M327.8,375.8l-5.7-8.7c-0.2-0.2-0.3-0.4-0.6-0.6l-8.7-5.7c-0.8-0.5-1.8-0.4-2.5,0.3 c-0.7,0.7-0.8,1.7-0.3,2.5l5.7,8.7c0.2,0.2,0.3,0.4,0.6,0.6l8.7,5.7c0.3,0.2,0.7,0.3,1.1,0.3c0.5,0,1-0.2,1.4-0.6 C328.3,377.7,328.4,376.6,327.8,375.8z M317.4,371.2l-5.7-8.7l8.7,5.7L317.4,371.2z"
					/>
				</g>
				<path class="letter-m" d="M380.8,345c0.1-0.6,0.5-1.1,1.4-1.1h1.2c0.6,0,1.1,0.3,1.3,0.7l16.5,33.8c0.2,0,0.2,0,0.2,0l16.5-33.8 c0.2-0.4,0.6-0.7,1.3-0.7h1.2c0.8,0,1.3,0.5,1.4,1.1l8.9,48.1c0.2,1-0.4,1.6-1.4,1.6h-6.8c-0.7,0-1.3-0.6-1.4-1.1l-4.4-27.2 c-0.1,0-0.2,0-0.2,0l-13.2,28.2c-0.2,0.4-0.6,0.8-1.3,0.8h-1.4c-0.7,0-1.1-0.4-1.3-0.8L386,366.6c0,0-0.2,0-0.2,0l-4.4,27.2 c-0.1,0.5-0.7,1.1-1.4,1.1h-6.8c-1,0-1.6-0.6-1.4-1.6L380.8,345z"
				/>
				<path class="letter-o" d="M483.6,343.9c15,0,27.1,11.5,27.1,25.9c0,14.3-12,25.7-27.1,25.7c-15,0-27-11.4-27-25.7 C456.6,355.4,468.6,343.9,483.6,343.9z M483.6,386.2c9.5,0,17.3-7.4,17.3-16.4c0-9-7.8-16.5-17.3-16.5c-9.5,0-17.2,7.5-17.2,16.5 C466.4,378.8,474.2,386.2,483.6,386.2z"
				/>
				<path class="letter-s" d="M537.8,389.9c-0.8-0.6-1.1-1-0.4-2.1l2.7-4.4c0.6-1,1.9-1,2.6-0.5c3.1,2.2,6.5,4.4,11.4,4.4 c3.9,0,6.8-2.4,6.8-5.5c0-3.7-3.2-6.2-9.5-8.6c-7.1-2.7-14.1-7-14.1-15.5c0-6.4,5-13.8,16.9-13.8c7.7,0,13.5,3.7,15,4.8 c0.8,0.4,1,1.6,0.5,2.4l-2.9,4.1c-0.6,0.9-1.7,1.4-2.6,0.9c-3.2-1.9-6.3-3.9-10.5-3.9c-4.3,0-6.6,2.3-6.6,5c0,3.4,2.8,5.7,8.9,8 c7.3,2.8,15.7,6.9,15.7,16.2c0,7.4-6.7,14.2-17.3,14.2C544.8,395.5,539.9,391.7,537.8,389.9z"
				/>
			</svg>

		</div>

		<h2 class="visualaws">VisuaLaws</h2>

		<div id="select" class="centerText">
			<h4>Please select a law to view</h4>
			<select id="law-select" onchange="loadLaw(this.value);">
			<option value="-1" selected disabled>Select a law...</option>
			<option value="06019">Apology Act</option>
			<option value="96007">Age of Majority Act</option>
			<option value="96466">Tug Boat Worker Lien Act</option>
			<option value="96080">Court Rules Act</option>
			<option value="96443">Supreme Court Act</option>
			<option value="96282">Marriage Act</option>
			<option value="96204">Hospital Insurance Act</option>
			<option value="96359">Personal Property Act</option>
			<option value="96113">Employment Standards Act</option>
		</select>
			<div id="error-message" style="display: none">
				<h3>Error, failed to load law.</h3>
			</div>
		</div>

		<div id="knomos-compass" style="display: none">
			<svg class="knomos-compass" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72.5 69.32">
				<title>Knomos Compass</title>
				<path class="dial" d="M71.6,33.62l-7.7-4.4a25.5,25.5,0,0,0-4.7-10.3,1.45,1.45,0,0,0,.2-0.7l0.8-5.4a1.78,1.78,0,0,0-.7-1.8,2,2,0,0,0-1.4-.6,0.9,0.9,0,0,0-.5.1l-5.3,1.2a1.69,1.69,0,0,0-.6.3A27,27,0,0,0,41.4,8l-4.3-7.5a1.21,1.21,0,0,0-2,0L30.8,8a30.43,30.43,0,0,0-10.4,4l-0.6-.3-5.3-1.2c-0.2,0-.3-0.1-0.5-0.1a2,2,0,0,0-1.4.6,2.2,2.2,0,0,0-.7,1.8l0.8,5.4a0.76,0.76,0,0,0,.2.5,0.1,0.1,0,0,0,.1.1,25.5,25.5,0,0,0-4.7,10.3l-7.7,4.4a1.13,1.13,0,0,0,0,2l7.7,4.4A26.33,26.33,0,0,0,13,50.42a0.9,0.9,0,0,0-.1.5l-0.8,5.4a1.78,1.78,0,0,0,.7,1.8,2,2,0,0,0,1.4.6,0.9,0.9,0,0,0,.5-0.1l5.3-1.2c0.1,0,.3-0.1.4-0.1a0.1,0.1,0,0,0,.1-0.1,29,29,0,0,0,10.5,4l4.3,7.5a1.13,1.13,0,0,0,2,0l4.3-7.5a30.43,30.43,0,0,0,10.4-4l0.6,0.3,5.3,1.2c0.2,0,.3.1,0.5,0.1a2,2,0,0,0,1.4-.6,2.2,2.2,0,0,0,.7-1.8L59.7,51c0-.1-0.1-0.3-0.1-0.4s-0.1-.1-0.1-0.2A25.91,25.91,0,0,0,64.2,40l7.7-4.4a1.1,1.1,0,0,0,.6-1A2.93,2.93,0,0,0,71.6,33.62Zm-35.5,24c-13.5,0-24.1-10.1-24.1-22.9s10.8-23.1,24.1-23.1,24.2,10.3,24.2,23.1S49.7,57.62,36.1,57.62Z"
				/>
				<path class="needle" d="M45,40.72L39.3,32a3.39,3.39,0,0,0-.6-0.6L30,25.72a2,2,0,0,0-2.8,2.8l5.7,8.7a3.39,3.39,0,0,0,.6.6l8.7,5.7a2,2,0,0,0,1.1.3,2,2,0,0,0,1.4-.6A1.76,1.76,0,0,0,45,40.72Zm-10.4-4.6-5.7-8.7,8.7,5.7Z"
				/>
			</svg>
		</div>
	</div>

	<div id="body" style="display: none">
		<div id="top-bar">
			<img src="knomos-beta-logo.png" class="logo" />
			<!-- <svg class="knomos-logo-small" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
				x="0px" y="0px" viewBox="150 315 425 90" style="enable-background:new 0 0 720 720;" xml:space="preserve">
				<path class="letter-k" d="M150.4,346.3c0-0.9,0.8-1.7,1.8-1.7h6.6c1,0,1.8,0.8,1.8,1.7v19.3l18.9-20.3c0.3-0.4,0.8-0.7,1.4-0.7h7.5 c1.4,0,2.2,1.5,1.2,2.6l-19.6,21.1l21.1,24c0.8,0.9,0.2,2.5-1.4,2.5h-8.2c-0.8,0-1.2-0.3-1.4-0.5l-19.6-23.1v21.9 c0,0.9-0.8,1.7-1.8,1.7h-6.6c-1.1,0-1.8-0.8-1.8-1.7V346.3z"
				/>
				<path class="letter-n" d="M218.2,345.2c0-0.7,0.7-1.3,1.4-1.3h1.1c0.5,0,0.9,0.1,1.3,0.5l30.7,31.2h0.2V346c0-0.7,0.6-1.4,1.4-1.4h6.9 c0.8,0,1.4,0.6,1.4,1.4v48.2c0,0.7-0.7,1.3-1.4,1.3h-1.1c-0.5,0-0.9-0.1-1.3-0.5l-30.8-32.4h-0.2v30.8c0,0.7-0.6,1.4-1.4,1.4h-6.8 c-0.8,0-1.4-0.6-1.4-1.4V345.2z"
				/>
				<g>
					<path class="star" d="M322.8,320.8L322.8,320.8c-1.4,0-2.6-1.2-2.6-2.6v-1.3c0-0.7-0.6-1.2-1.2-1.2s-1.2,0.6-1.2,1.2v1.3 c0,1.4-1.2,2.6-2.6,2.6l0,0c-0.7,0-1.2,0.6-1.2,1.2s0.6,1.2,1.2,1.2l0,0c1.4,0,2.6,1.2,2.6,2.6v1.3c0,0.7,0.6,1.2,1.2,1.2 s1.2-0.6,1.2-1.2v-1.3c0-1.4,1.2-2.6,2.6-2.6h0c0.7,0,1.2-0.6,1.2-1.2S323.5,320.8,322.8,320.8z"
					/>
					<path class="dial" d="M354.4,368.7l-7.7-4.4c-0.8-3.8-2.4-7.3-4.7-10.3c0.1-0.2,0.2-0.4,0.2-0.7l0.8-5.4c0.1-0.7-0.1-1.4-0.7-1.8 c-0.4-0.4-0.9-0.6-1.4-0.6c-0.2,0-0.3,0-0.5,0.1l-5.3,1.2c-0.2,0.1-0.4,0.1-0.6,0.3c-3.1-2-6.6-3.4-10.3-4l-4.3-7.5 c-0.4-0.7-1.6-0.7-2,0l-4.3,7.5c-3.8,0.7-7.3,2.1-10.4,4c-0.2-0.1-0.4-0.2-0.6-0.3l-5.3-1.2c-0.2,0-0.3-0.1-0.5-0.1 c-0.5,0-1,0.2-1.4,0.6c-0.5,0.5-0.8,1.2-0.7,1.8l0.8,5.4c0,0.2,0.1,0.4,0.2,0.5c0,0,0,0.1,0.1,0.1c-2.3,3-3.9,6.5-4.7,10.3 l-7.7,4.4c-0.4,0.2-0.6,0.6-0.6,1c0,0.4,0.2,0.8,0.6,1l7.7,4.4c0.8,3.9,2.4,7.4,4.7,10.5c-0.1,0.2-0.1,0.3-0.1,0.5l-0.8,5.4 c-0.1,0.7,0.1,1.4,0.7,1.8c0.4,0.4,0.9,0.6,1.4,0.6c0.2,0,0.3,0,0.5-0.1l5.3-1.2c0.1,0,0.3-0.1,0.4-0.1c0,0,0.1,0,0.1-0.1 c3.1,2,6.7,3.3,10.5,4l4.3,7.5c0.2,0.4,0.6,0.6,1,0.6s0.8-0.2,1-0.6l4.3-7.5c3.8-0.7,7.3-2.1,10.4-4c0.2,0.1,0.4,0.2,0.6,0.3 l5.3,1.2c0.2,0,0.3,0.1,0.5,0.1c0.5,0,1-0.2,1.4-0.6c0.5-0.5,0.8-1.2,0.7-1.8l-0.8-5.4c0-0.1-0.1-0.3-0.1-0.4 c0-0.1-0.1-0.1-0.1-0.2c2.3-3,3.9-6.6,4.7-10.4l7.7-4.4c0.4-0.2,0.6-0.6,0.6-1C355,369.3,354.8,368.9,354.4,368.7z M318.9,392.7 c-13.5,0-24.1-10.1-24.1-22.9c0-12.7,10.8-23.1,24.1-23.1c13.4,0,24.2,10.3,24.2,23.1C343.1,382.6,332.5,392.7,318.9,392.7z"
					/>
					<path class="needle" d="M327.8,375.8l-5.7-8.7c-0.2-0.2-0.3-0.4-0.6-0.6l-8.7-5.7c-0.8-0.5-1.8-0.4-2.5,0.3 c-0.7,0.7-0.8,1.7-0.3,2.5l5.7,8.7c0.2,0.2,0.3,0.4,0.6,0.6l8.7,5.7c0.3,0.2,0.7,0.3,1.1,0.3c0.5,0,1-0.2,1.4-0.6 C328.3,377.7,328.4,376.6,327.8,375.8z M317.4,371.2l-5.7-8.7l8.7,5.7L317.4,371.2z"
					/>
				</g>
				<path class="letter-m" d="M380.8,345c0.1-0.6,0.5-1.1,1.4-1.1h1.2c0.6,0,1.1,0.3,1.3,0.7l16.5,33.8c0.2,0,0.2,0,0.2,0l16.5-33.8 c0.2-0.4,0.6-0.7,1.3-0.7h1.2c0.8,0,1.3,0.5,1.4,1.1l8.9,48.1c0.2,1-0.4,1.6-1.4,1.6h-6.8c-0.7,0-1.3-0.6-1.4-1.1l-4.4-27.2 c-0.1,0-0.2,0-0.2,0l-13.2,28.2c-0.2,0.4-0.6,0.8-1.3,0.8h-1.4c-0.7,0-1.1-0.4-1.3-0.8L386,366.6c0,0-0.2,0-0.2,0l-4.4,27.2 c-0.1,0.5-0.7,1.1-1.4,1.1h-6.8c-1,0-1.6-0.6-1.4-1.6L380.8,345z"
				/>
				<path class="letter-o" d="M483.6,343.9c15,0,27.1,11.5,27.1,25.9c0,14.3-12,25.7-27.1,25.7c-15,0-27-11.4-27-25.7 C456.6,355.4,468.6,343.9,483.6,343.9z M483.6,386.2c9.5,0,17.3-7.4,17.3-16.4c0-9-7.8-16.5-17.3-16.5c-9.5,0-17.2,7.5-17.2,16.5 C466.4,378.8,474.2,386.2,483.6,386.2z"
				/>
				<path class="letter-s" d="M537.8,389.9c-0.8-0.6-1.1-1-0.4-2.1l2.7-4.4c0.6-1,1.9-1,2.6-0.5c3.1,2.2,6.5,4.4,11.4,4.4 c3.9,0,6.8-2.4,6.8-5.5c0-3.7-3.2-6.2-9.5-8.6c-7.1-2.7-14.1-7-14.1-15.5c0-6.4,5-13.8,16.9-13.8c7.7,0,13.5,3.7,15,4.8 c0.8,0.4,1,1.6,0.5,2.4l-2.9,4.1c-0.6,0.9-1.7,1.4-2.6,0.9c-3.2-1.9-6.3-3.9-10.5-3.9c-4.3,0-6.6,2.3-6.6,5c0,3.4,2.8,5.7,8.9,8 c7.3,2.8,15.7,6.9,15.7,16.2c0,7.4-6.7,14.2-17.3,14.2C544.8,395.5,539.9,391.7,537.8,389.9z"
				/>
			</svg> -->
		</div>

		<div id="title-bar">
			<h2 class="title" id="title"></h2>
		</div>

		<div id="main-content">

			<div id="slider-div" class="slider-div view">
				<div id="slider-container" class="slider-container">
					<div id="slider" class="slider"></div>
				</div>
				<span id='enacted' class='enacted'>Changes unavailable before 2000.</span>
			</div>

			<div id="icicle-div" class="icicle-div view">
				<div id="above-icicle" class="outside-icicle above-icicle">
					<div id="added-above-icicle" class="bar-added"></div>
					<div id="changed-above-icicle" class="bar-changed"></div>
					<div id="removed-above-icicle" class="bar-removed"></div>
				</div>
				<div id="icicle-scroll" class="icicle-scroll">
					<div id="icicle" class="icicle">
					</div>
				</div>
				<div id="below-icicle" class="outside-icicle below-icicle">
					<div id="added-below-icicle" class="bar-added"></div>
					<div id="changed-below-icicle" class="bar-changed"></div>
					<div id="removed-below-icicle" class="bar-removed"></div>
				</div>
			</div>

			<div id="main-diff-container" class="main-diff-div view">
				<div id="main-diff">
				</div>
			</div>

		</div>



		<!-- <div class="added"></div> -->


		<!-- <div id="scented-scroll"></div> -->


		<!-- <div id="legend-div" class="legend-div centerText">
			<table>
				<tr>
					<td>
						<div class="bar-added legend-bar"></div>
						<div class="legend-label"> Enacted</div>
						</br>
						<div class="bar-changed legend-bar"></div>
						<div class="legend-label"> Amended</div>
						</br>
						<div class="bar-removed legend-bar"></div>
						<div class="legend-label"> Repealed</div>
						</br>
					</td>
				</tr>
			</table>
		</div> -->
	</div>
	<script>
		function loadLaw(id) {
			var opts = {
				lines: 11 // The number of lines to draw
				, length: 35 // The length of each line
				, width: 41 // The line thickness
				, radius: 0 // The radius of the inner circle
				, scale: 1.25 // Scales overall size of the spinner
				, corners: 1 // Corner roundness (0..1)
				, color: '#000' // #rgb or #rrggbb or array of colors
				, opacity: 0.2 // Opacity of the lines
				, rotate: 90 // The rotation offset
				, direction: 1 // 1: clockwise, -1: counterclockwise
				, speed: 1 // Rounds per second
				, trail: 48 // Afterglow percentage
				, fps: 20 // Frames per second when using setTimeout() as a fallback for CSS
				, zIndex: 2e9 // The z-index (defaults to 2000000000)
				, className: 'spinner' // The CSS class to assign to the spinner
				, top: '50%' // Top position relative to parent
				, left: '50%' // Left position relative to parent
				, shadow: true // Whether to render a shadow
				, hwaccel: false // Whether to use hardware acceleration
				, position: 'absolute' // Element positioning
			}

			/**
			 * jabney 07-Mar-2017
			   var target = document.getElementById('spinner')
			   spinner = new Spinner(opts).spin(target);
			 */

			/**
			 * jabney 07-Mar-2017
			 * Show the loading compass.
			 */
			$('#knomos-compass').css('display', 'block');

			try {

				$.ajax
					({
						type: "GET",
						url: "http://kn-bcb.herokuapp.com/api/bcl_proxy",
						data: { url: "/civix/document/id/complete/statreg/" + id + "_01/xml" }, //Court Rules Act
						beforeSend: function (xhr) {
							xhr.setRequestHeader("Authorization", "Basic " + btoa("kimdr" + ":" + "zIMSNyE5iRDDsX00vDLCNFSHTAKr0odF"));
						},
						success: function (xml) {

							xml1 = xml;

							$.ajax
								({
									type: "GET",
									url: "http://kn-bcb.herokuapp.com/api/bcl_proxy",
									data: { url: "/civix/document/id/complete/statreg/" + id + "_pit/xml" },
									beforeSend: function (xhr) {
										xhr.setRequestHeader("Authorization", "Basic " + btoa("kimdr" + ":" + "zIMSNyE5iRDDsX00vDLCNFSHTAKr0odF"));
									},
									success: function (xml2) {
										/**
										 * jabney 07-Mar-2017
										 * Remove the title screen.
										 */
										$('#title-screen').remove();

										//---------------------------------------------------------------------------------------
										//Loading all the data and objects needed.

										//Get the hard-coded Court Rules Act Data
										wrapper = loadData(xml1, xml2);
										data = wrapper.data;
										dates = wrapper.dates;
										//Get the non-hard-coded Court Rules Act Data
										//act = $.xml2json(xml);

										//Formart the Court Rules Act Data for the Icicle plot.
										icyAct = wrapper.icyData;
										//var icyAct = icicleData(act);
										console.log(icyAct);

										//Create the diff tool.
										dmp = new diff_match_patch();

										$("#body").css("display", "inline");

										/**
										 * jabney 07-Mar-2017
										   $("#spinner").css("display", "none");
										   spinner.stop();
										 */

										//Add the first date to the dates array.
										dates = [new Date("January 1, 2000")];
										//Add all the changed dates to the dates array.
										for (var i = 0; i < changeData.length; i++)
											dates.push(new Date(changeData[i].date));
										//Add today's date to the date array.
										dates.push(today);


										//------------------------------------------------------------------------
										//Slider stuff

										var output = makeTicks(dates);

										var tickArray = output[0];
										var tickLabels = output[1];
										var maxTick = output[2];


										$(function () {
											$("#slider").labeledslider({
												orientation: "vertical",
												tickArray: tickArray,
												tickLabels: tickLabels,
												values: [0, maxTick],
												min: 0,
												max: maxTick,
												slide: onSlide
											});
											$("#title").html(act.name + ": Dates " + formatDate($("#slider").labeledslider("labels", 0)) +
												" vs " + formatDate($("#slider").labeledslider("labels", 1)));
										});


										//---------------------------------------------------------------------------------------
										//Icicle plot

										d3.selection.prototype.moveToFront = function () { /*return this.each(function() { this.parentNode.appendChild(this); }); */ };

										icicle = {};

										icicle.d = {};
										icicle.d.x = 0;
										icicle.d.y = 0;
										icicle.d.dx = 1;
										icicle.d.dy = 0.2;

										icicle.partition = d3.layout.partition()
											.children(function (d) { return isNaN(d.value) ? d3.entries(d.value) : null; })
											.value(function (d) { return d.value; })
											.sort(null);

										icyLayoutData = icicle.partition(d3.entries(icyAct)[0]);

										console.log(icyLayoutData[0].value);

										icicle.width = $("#icicle").width() - 20;
										icicle.height = Math.max(icyLayoutData[0].value, ($("#icicle-div").height() - $("#icicle-title").height()) - 20);

										$("#icicle-scroll").height($("#icicle-div").height() - $("#icicle-title").height() - 20);
										//icicle.height = ;

										icicle.x = d3.scale.linear()
											.range([0, icicle.width]);

										icicle.y = d3.scale.linear()
											.range([0, icicle.height]);




										icicle.svg = d3.select("#icicle").append("svg")
											.attr("width", icicle.width)
											.attr("height", icicle.height);

										icicle.g = icicle.svg.selectAll("g");



										icicle.g = icicle.g
											.data(icyLayoutData)
											.enter().append("g")
											.attr("x", function (d) { return icicle.x(d.y); })
											.attr("y", function (d) { return icicle.y(d.x); })
											.sort(function (d1, d2) {
												less = -1;
												more = 1;
												if (d1.y < d2.y)
													return less;
												else if (d1.y > d2.y)
													return more;
												else if (d1.x < d2.x)
													return less;
												else if (d1.x > d2.x)
													return more;
												else
													return 0;
											});

										icicle.rect = icicle.g.append("rect")
											.attr("x", function (d) { return icicle.x(d.y); })
											.attr("y", function (d) { return icicle.y(d.x); })
											.attr("width", function (d) { return icicle.x(d.dy) - 1; })
											.attr("height", function (d) { return icicle.y(d.dx); })
											.attr("id", function (d) { return d.key; })
											.on("click", onClick)
											.on("dblclick", onDblClick)
											.on("mouseover", onMouseOverIcicle)
											.on("mouseout", onMouseOutIcicle);

										$('svg rect').tipsy({
											gravity: 'sw',
											html: true,
											title: onHoverIcicleTitle
										});

										/*
										icicle = {};
				
										icicle.width = 150;
										icicle.height = 550;
				
										icicle.x = d3.scale.linear()
											.range([0, icicle.width]);
				
										icicle.y = d3.scale.linear()
											.range([0, icicle.height]);
				
				
										icicle.partition = d3.layout.partition()
											.children(function(d) { return isNaN(d.value) ? d3.entries(d.value) : null; })
											.value(function(d) { return d.value; })
											.sort(null);
				
										icicle.svg = d3.select("#icicle").append("svg")
											.attr("width", icicle.width)
											.attr("height", icicle.height);
				
										icicle.rect = icicle.svg.selectAll("rect");
				
										icicle.rect = icicle.rect
										  .data(icicle.partition(d3.entries(icyAct)[0]))
										.enter().append("rect")
										  .attr("x", function(d) { return icicle.x(d.y); })
										  .attr("y", function(d) { return icicle.y(d.x); })
										  .attr("width", function(d) { return icicle.x(d.dy); })
										  .attr("height", function(d) { return icicle.y(d.dx); })
										  .attr("id", function(d) { return d.key; })
										  .on("click", onClick)
										  .on("dblclick", onDblClick);
				
										$('svg rect').tipsy({
											gravity: 'w',
											html: true,
											title: onHover
										});
				
										*/


										//--------------------------------------------------------------------
										//Main Diff View Stuff


										//Create the main diff view
										update([dates[0], dates[dates.length - 1]]);

										//--------------------------------------------------------------------
										//Putting text labels on the icicle plot.

										icicle.text = icicle.g.append("text")
											.text(icicleLabel);
										//We need to set the text label twice so that on the second pass we remove labels that don't fit in their boxes.
										//icicle.text.text(icicleLabel);
										icicle.text.text(icicleLabel);

										icicle.text
											.attr("x", function (d) { return icicle.x(d.y) + (icicle.x(d.y + d.dy) - icicle.x(d.y)) / 2 - this.getBBox().width / 2; })
											.attr("y", function (d) { return icicle.y(d.x) + (icicle.y(d.x + d.dx) - icicle.y(d.x)) / 2 + this.getBBox().height / 4; })
											.attr("width", function (d) { return icicle.x(d.y + d.dy) - icicle.x(d.y); })
											.attr("height", function (d) { return icicle.y(d.x + d.dx) - icicle.y(d.x); })
											.on("click", onClick)
											.on("dblclick", onDblClick)
											.on("mouseover", onMouseOverIcicle)
											.on("mouseout", onMouseOutIcicle);

										$('svg text').tipsy({
											gravity: 'swr',
											html: true,
											title: onHoverIcicleTitle
										});

										//--------------------------------------------------------------------
										//Handle window resizing

										resizeWindow();
										resizeScent();
										$(window).resize(resizeWindow);






										//--------------------------------------------------------------------
										//Setting up onScrolling events

										$("#main-diff-container").scroll(onScroll);
										$("#icicle-scroll").scroll(onChangeFrame);
										onChangeFrame();
									}

								});

						}


					});

			} catch (err) {
				$("#error-message").css("display", "inline");

				/**
				 * jabney removed 07-Mar-2017
				   $("#spinner").css("display", "none");
				   spinner.stop();
				 */
			}

		}
		// TODO/HACK: FH: Remove this; just automatically loads the Apology Act
		loadLaw('06019');
	</script>

</body>

</html>